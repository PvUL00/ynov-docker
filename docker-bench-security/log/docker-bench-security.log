Initializing 2025-01-12T14:42:33+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;31m[WARN][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;31m[WARN][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;31m[WARN][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;31m[WARN][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;31m[WARN][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;31m[WARN][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;31m[WARN][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;31m[WARN][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;31m[WARN][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;31m[WARN][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;31m[WARN][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;34m[INFO][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: caddy
[1;31m[WARN][0m      * Running as root: redis
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: caddy
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: caddy
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: caddy
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;31m[WARN][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m       * Privileges not restricted: caddy
[1;31m[WARN][0m       * Privileges not restricted: redis
[1;31m[WARN][0m       * Privileges not restricted: flask_app
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: caddy
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 5

Initializing 2025-01-12T14:59:51+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;31m[WARN][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;31m[WARN][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;34m[INFO][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: redis
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;31m[WARN][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m       * Privileges not restricted: redis
[1;31m[WARN][0m       * Privileges not restricted: flask_app
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 27

Initializing 2025-01-12T15:04:06+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;31m[WARN][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;31m[WARN][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;34m[INFO][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: redis
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;31m[WARN][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m       * Privileges not restricted: redis
[1;31m[WARN][0m       * Privileges not restricted: flask_app
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 27

Initializing 2025-01-12T15:06:58+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;31m[WARN][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
Initializing 2025-01-12T15:09:07+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;34m[INFO][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: redis
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;31m[WARN][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m       * Privileges not restricted: redis
[1;31m[WARN][0m       * Privileges not restricted: flask_app
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 35

Initializing 2025-01-12T15:12:09+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;34m[INFO][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: redis
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;31m[WARN][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m       * Privileges not restricted: redis
[1;31m[WARN][0m       * Privileges not restricted: flask_app
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 35

Initializing 2025-01-12T15:28:03+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;34m[INFO][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;34m[INFO][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: redis
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;31m[WARN][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m       * Privileges not restricted: redis
[1;31m[WARN][0m       * Privileges not restricted: flask_app
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 37

Initializing 2025-01-12T15:53:53+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: flask_app
[1;31m[WARN][0m      * Running as root: caddy
[1;31m[WARN][0m      * Running as root: redis
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m       * Container running without memory restrictions: caddy
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m       * Container running without CPU restrictions: caddy
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;31m[WARN][0m       * Container running with root FS mounted R/W: caddy
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: flask_app
[1;31m[WARN][0m       * Health check not set: caddy
[1;31m[WARN][0m       * Health check not set: redis
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 40

Initializing 2025-01-12T16:19:39+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m       * Container running without memory restrictions: caddy
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m       * Container running without CPU restrictions: caddy
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;31m[WARN][0m       * Container running with root FS mounted R/W: caddy
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;31m[WARN][0m       * Health check not set: caddy
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 42

Initializing 2025-01-12T16:30:14+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
Initializing 2025-01-12T16:30:36+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m       * Container running without memory restrictions: caddy
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m       * Container running without CPU restrictions: caddy
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;31m[WARN][0m       * Container running with root FS mounted R/W: caddy
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;31m[WARN][0m       * Health check not set: caddy
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 44

Initializing 2025-01-12T16:31:43+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m       * Container running without memory restrictions: caddy
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m       * Container running without CPU restrictions: caddy
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;31m[WARN][0m       * Container running with root FS mounted R/W: caddy
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;31m[WARN][0m       * Health check not set: caddy
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 46

Initializing 2025-01-12T16:37:13+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;31m[WARN][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;31m[WARN][0m       * Container running without memory restrictions: redis
[1;31m[WARN][0m       * Container running without memory restrictions: flask_app
[1;31m[WARN][0m       * Container running without memory restrictions: caddy
[1;31m[WARN][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;31m[WARN][0m       * Container running without CPU restrictions: redis
[1;31m[WARN][0m       * Container running without CPU restrictions: flask_app
[1;31m[WARN][0m       * Container running without CPU restrictions: caddy
[1;31m[WARN][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: redis
[1;31m[WARN][0m       * Container running with root FS mounted R/W: flask_app
[1;31m[WARN][0m       * Container running with root FS mounted R/W: caddy
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;31m[WARN][0m       * Health check not set: caddy
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 46

Initializing 2025-01-12T16:55:50+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: redis
[1;31m[WARN][0m       * Health check not set: flask_app
[1;31m[WARN][0m       * Health check not set: caddy
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;31m[WARN][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;31m[WARN][0m       * PIDs limit not set: redis
[1;31m[WARN][0m       * PIDs limit not set: flask_app
[1;31m[WARN][0m       * PIDs limit not set: caddy
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 54

Initializing 2025-01-12T17:01:50+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 58

Initializing 2025-01-13T19:01:39+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 52

Initializing 2025-01-13T19:07:24+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 50

Initializing 2025-01-14T19:05:25+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: bd691a5d9e56
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: 452912b0da3d
[1;31m[WARN][0m      * No Healthcheck found: 1ab9781a44c3
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;31m[WARN][0m      * No Healthcheck found: 4f1093e75aad
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 9 images
[1;34m[INFO][0m      * Only 3 out of 9 are in use
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 52

Initializing 2025-01-14T19:15:07+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 50

Initializing 2025-01-14T19:29:11+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 50

Initializing 2025-01-14T19:32:13+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-redis:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-14T19:39:24+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: 3665237a0134
[1;31m[WARN][0m      * No Healthcheck found: 2a313071947f
[1;31m[WARN][0m      * No Healthcheck found: 7fa776662d9c
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 58

Initializing 2025-01-14T19:42:29+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-16T19:05:33+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 54

Initializing 2025-01-16T19:05:56+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-16T19:24:18+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 64

Initializing 2025-01-16T19:29:24+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 64

Initializing 2025-01-16T19:32:04+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;32m[PASS][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;32m[PASS][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 0 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 0 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 42

Initializing 2025-01-16T19:33:05+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m      * Only 0 out of 3 are in use
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 0 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 42

Initializing 2025-01-16T19:33:42+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 64

Initializing 2025-01-16T19:51:12+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 64

Initializing 2025-01-16T19:54:44+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;32m[PASS][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 2 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 56

Initializing 2025-01-17T10:28:09+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 52

Initializing 2025-01-17T10:28:55+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-17T10:41:31+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-17T10:51:13+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-17T11:05:06+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-17T11:14:10+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-17T11:18:22+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;31m[WARN][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;31m[WARN][0m       * Port being bound to wildcard IP: 0.0.0.0 in caddy
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 5 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 58

Initializing 2025-01-17T11:32:48+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 5 images
[1;34m[INFO][0m      * Only 0 out of 5 are in use
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 0 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 40

Initializing 2025-01-17T11:33:41+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m      * Only 0 out of 6 are in use
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 0 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 40

Initializing 2025-01-17T11:34:40+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-17T12:12:08+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-18T19:05:52+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 34

Initializing 2025-01-18T19:07:23+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-18T19:30:31+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-19T10:05:59+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-19T10:37:57+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-19T10:54:18+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m      * Only 1 out of 4 are in use
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 1 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 40

Initializing 2025-01-19T10:55:13+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;31m[WARN][0m      * Running as root: flask_app
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [ynov-docker-backend:latest]
[1;31m[WARN][0m      * No Healthcheck found: [caddy:latest]
[1;31m[WARN][0m      * No Healthcheck found: [redis:alpine]
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;34m[INFO][0m      * ADD in image history: [caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;31m[WARN][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;31m[WARN][0m       * Health check not set: flask_app
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 6 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 56

Initializing 2025-01-19T10:58:32+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;32m[PASS][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;32m[PASS][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 1 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 1 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 40

Initializing 2025-01-19T10:59:56+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;31m[WARN][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;31m[WARN][0m      * No Healthcheck found: [hello-world:latest]
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-19T11:06:40+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-23T09:35:16+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
Initializing 2025-01-23T09:35:43+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 4 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-23T09:49:33+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;31m[WARN][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 60

Initializing 2025-01-23T10:23:53+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m      * Only 0 out of 3 are in use
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 0 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 42

Initializing 2025-01-23T10:24:29+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-23T10:25:40+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 62

Initializing 2025-01-23T10:30:01+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 34

Initializing 2025-01-23T10:39:25+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
Initializing 2025-01-23T10:40:55+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 36

Initializing 2025-01-23T10:52:07+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1.1 - For new installations, you should create a separate partition for the /var/lib/docker mount point. For systems that have already been installed, you should use the Logical Volume Manager (LVM) within Linux to create a new partition. Remediation Impact: None.
[1;34m[INFO][0m 1.1.2 - You should remove any untrusted users from the docker group using command sudo gpasswd -d <your-user> docker or add trusted users to the docker group using command sudo usermod -aG docker <your-user>. You should not create a mapping of sensitive directories from the host to container volumes. Remediation Impact: Only trust user are allow to build and execute containers as normal user.
[1;34m[INFO][0m 1.1.8 - Install auditd. Add -w /run/containerd/containerd.sock -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.9 - Install auditd. Add -w /lib/systemd/system/docker.socket -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.10 - Install auditd. Add -w /etc/default/docker -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.11 - Install auditd. Add -w /etc/docker/daemon.json -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.13 - Install auditd. Add -w /etc/sysconfig/docker -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.2.1 - You may consider various Security Benchmarks for your container host. Remediation Impact: None.

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;34m[INFO][0m 2.1 - Follow the current Dockerdocumentation on how to install the Docker daemon as a non-root user. Remediation Impact: There are multiple prerequisites depending on which distribution that is in use, and also known limitations regarding networking and resource limitation. Running in rootless mode also changes the location of any configuration files in use, including all containers using the daemon.
[1;34m[INFO][0m 2.2 - Edit the Docker daemon configuration file to ensure that inter-container communication is disabled: icc: false. Remediation Impact: Inter-container communication is disabled on the default network bridge. If any communication between containers on the same host is desired, it needs to be explicitly defined using container linking or custom networks.
[1;34m[INFO][0m 2.7 - Follow the steps mentioned in the Docker documentation or other references. By default, TLS authentication is not configured. Remediation Impact: You would need to manage and guard certificates and keys for the Docker daemon and Docker clients.
[1;34m[INFO][0m 2.8 - Run Docker in daemon mode and pass --default-ulimit as option with respective ulimits as appropriate in your environment and in line with your security policy. Example: dockerd --default-ulimit nproc=1024:2048 --default-ulimit nofile=100:200 Remediation Impact: If ulimits are set incorrectly this could cause issues with system resources, possibly causing a denial of service condition.
[1;34m[INFO][0m 2.9 - Please consult the Docker documentation for various ways in which this can be configured depending upon your requirements. The high-level steps are: Ensure that the files /etc/subuid and /etc/subgid exist. Start the docker daemon with --userns-remap flag. Remediation Impact: User namespace remapping is incompatible with a number of Docker features and also currently breaks some of its functionalities.
[1;34m[INFO][0m 2.12 - Install/Create an authorization plugin. Configure the authorization policy as desired. Start the docker daemon using command dockerd --authorization-plugin=<PLUGIN_ID> Remediation Impact: Each Docker command needs to pass through the authorization plugin mechanism. This may have a performance impact
[1;34m[INFO][0m 2.13 - Set up the desired log driver following its documentation. Start the docker daemon using that logging driver. Example: dockerd --log-driver=syslog --log-opt syslog-address=tcp://192.xxx.xxx.xxx Remediation Impact: None.
[1;34m[INFO][0m 2.14 - You should run the Docker daemon using command: dockerd --no-new-privileges Remediation Impact: no_new_priv prevents LSMs such as SELinux from escalating the privileges of individual containers.
[1;34m[INFO][0m 2.15 - Run Docker in daemon mode and pass --live-restore option. Remediation Impact: None.
[1;34m[INFO][0m 2.16 - You should run the Docker daemon using command: dockerd --userland-proxy=false Remediation Impact: Some systems with older Linux kernels may not be able to support hairpin NAT and therefore require the userland proxy service. Also, some networking setups can be impacted by the removal of the userland proxy.
[1;34m[INFO][0m 2.17 - By default, Docker's default seccomp profile is applied. If this is adequate for your environment, no action is necessary. Remediation Impact: A misconfigured seccomp profile could possibly interrupt your container environment. You should therefore exercise extreme care if you choose to override the default settings.
[1;34m[INFO][0m 2.18 - You should not pass --experimental as a runtime parameter to the Docker daemon on production systems. Remediation Impact: None.

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;34m[INFO][0m 3.7 - You should run the following command: chown root:root /etc/docker/certs.d/<registry-name>/*. This would set the individual ownership and group ownership for the registry certificate files to root. Remediation Impact: None.
[1;34m[INFO][0m 3.8 - You should run the following command: chmod 444 /etc/docker/certs.d/<registry-name>/*. This would set the permissions for the registry certificate files to 444. Remediation Impact: None.
[1;34m[INFO][0m 3.9 - You should run the following command: chown root:root <path to TLS CA certificate file>. This sets the individual ownership and group ownership for the TLS CA certificate file to root. Remediation Impact: None.
[1;34m[INFO][0m 3.10 - You should run the following command: chmod 444 <path to TLS CA certificate file>. This sets the file permissions on the TLS CA file to 444. Remediation Impact: None.
[1;34m[INFO][0m 3.11 - You should run the following command: chown root:root <path to Docker server certificate file>. This sets the individual ownership and the group ownership for the Docker server certificate file to root. Remediation Impact: None.
[1;34m[INFO][0m 3.12 - You should run the following command: chmod 444 <path to Docker server certificate file>. This sets the file permissions of the Docker server certificate file to 444. Remediation Impact: None.
[1;34m[INFO][0m 3.13 - You should run the following command: chown root:root <path to Docker server certificate key file>. This sets the individual ownership and group ownership for the Docker server certificate key file to root. Remediation Impact: None.
[1;34m[INFO][0m 3.14 - You should run the following command: chmod 400 <path to Docker server certificate key file>. This sets the Docker server certificate key file permissions to 400. Remediation Impact: None.
[1;34m[INFO][0m 3.21 - You should run the following command: chmod 644 /etc/sysconfig/docker. This sets the file permissions for this file to 644. Remediation Impact: None.
[1;34m[INFO][0m 3.22 - You should run the following command: chown root:root /etc/sysconfig/docker. This sets the ownership and group ownership for the file to root. Remediation Impact: None.

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - You should ensure that the Dockerfile for each container image contains the information: USER <username or ID>. If there is no specific user created in the container base image, then make use of the useradd command to add a specific user before the USER instruction in the Dockerfile. Remediation Impact: Running as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.
[1;34m[INFO][0m 4.2 - Configure and use Docker Content trust. View the history of each Docker image to evaluate its risk, dependent on the sensitivity of the application you wish to deploy using it. Scan Docker images for vulnerabilities at regular intervals. Remediation Impact: None.
[1;34m[INFO][0m 4.3 - You should not install anything within the container that is not required. You should consider using a minimal base image if you can. Some of the options available include BusyBox and Alpine. Not only can this trim your image size considerably, but there would also be fewer pieces of software which could contain vectors for attack. Remediation Impact: None.
[1;34m[INFO][0m 4.4 - Images should be re-built ensuring that the latest version of the base images are used, to keep the operating system patch level at an appropriate level. Once the images have been re-built, containers should be re-started making use of the updated images. Remediation Impact: None.
[1;34m[INFO][0m 4.7 - You should use update instructions together with install instructions and version pinning for packages while installing them. This prevent caching and force the extraction of the required versions. Alternatively, you could use the --no-cache flag during the docker build process to avoid using cached layers. Remediation Impact: None.
[1;34m[INFO][0m 4.8 - You should allow setuid and setgid permissions only on executables which require them. You could remove these permissions at build time by adding the following command in your Dockerfile, preferably towards the end of the Dockerfile: RUN find / -perm /6000 -type f -exec chmod a-s {} ; || true Remediation Impact: The above command would break all executables that depend on setuid or setgid permissions including legitimate ones. You should therefore be careful to modify the command to suit your requirements so that it does not reduce the permissions of legitimate programs excessively. Because of this, you should exercise a degree of caution and examine all processes carefully before making this type of modification in order to avoid outages.
[1;34m[INFO][0m 4.9 - You should use COPY rather than ADD instructions in Dockerfiles. Remediation Impact: Care needs to be taken in implementing this control if the application requires functionality that is part of the ADD instruction, for example, if you need to retrieve files from remote URLS.
[1;34m[INFO][0m 4.10 - Do not store any kind of secrets within Dockerfiles. Where secrets are required during the build process, make use of a secrets management tool, such as the buildkit builder included with Docker. Remediation Impact: A proper secrets management process will be required for Docker image building.
[1;34m[INFO][0m 4.11 - You should use a secure package distribution mechanism of your choice to ensure the authenticity of software packages. Remediation Impact: None.
[1;34m[INFO][0m 4.12 - Validate artifacts signatures before uploading to the package registry. Remediation Impact: None.

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - You should keep only the images that you actually need and establish a workflow to remove old or stale images from the host. Additionally, you should use features such as pull-by-digest to get specific images from the registry. Remediation Impact: docker system prune -a removes all exited containers as well as all images and volumes that are not referenced by running containers, including for UCP and DTR.
[1;34m[INFO][0m 6.2 - You should periodically check your container inventory on each host and clean up containers which are not in active use with the command: docker container prune Remediation Impact: You should retain containers that are actively in use, and delete ones which are no longer needed.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 26

Initializing 2025-01-23T10:52:33+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1.1 - For new installations, you should create a separate partition for the /var/lib/docker mount point. For systems that have already been installed, you should use the Logical Volume Manager (LVM) within Linux to create a new partition. Remediation Impact: None.
[1;34m[INFO][0m 1.1.2 - You should remove any untrusted users from the docker group using command sudo gpasswd -d <your-user> docker or add trusted users to the docker group using command sudo usermod -aG docker <your-user>. You should not create a mapping of sensitive directories from the host to container volumes. Remediation Impact: Only trust user are allow to build and execute containers as normal user.
[1;34m[INFO][0m 1.1.8 - Install auditd. Add -w /run/containerd/containerd.sock -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.9 - Install auditd. Add -w /lib/systemd/system/docker.socket -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.10 - Install auditd. Add -w /etc/default/docker -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.11 - Install auditd. Add -w /etc/docker/daemon.json -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.1.13 - Install auditd. Add -w /etc/sysconfig/docker -k docker to the /etc/audit/rules.d/audit.rules file. Then restart the audit daemon using command service auditd restart. Remediation Impact: Audit can generate large log files. So you need to make sure that they are rotated and archived periodically. Create a separate partition for audit logs to avoid filling up other critical partitions.
[1;34m[INFO][0m 1.2.1 - You may consider various Security Benchmarks for your container host. Remediation Impact: None.

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;34m[INFO][0m 2.1 - Follow the current Dockerdocumentation on how to install the Docker daemon as a non-root user. Remediation Impact: There are multiple prerequisites depending on which distribution that is in use, and also known limitations regarding networking and resource limitation. Running in rootless mode also changes the location of any configuration files in use, including all containers using the daemon.
[1;34m[INFO][0m 2.2 - Edit the Docker daemon configuration file to ensure that inter-container communication is disabled: icc: false. Remediation Impact: Inter-container communication is disabled on the default network bridge. If any communication between containers on the same host is desired, it needs to be explicitly defined using container linking or custom networks.
[1;34m[INFO][0m 2.7 - Follow the steps mentioned in the Docker documentation or other references. By default, TLS authentication is not configured. Remediation Impact: You would need to manage and guard certificates and keys for the Docker daemon and Docker clients.
[1;34m[INFO][0m 2.8 - Run Docker in daemon mode and pass --default-ulimit as option with respective ulimits as appropriate in your environment and in line with your security policy. Example: dockerd --default-ulimit nproc=1024:2048 --default-ulimit nofile=100:200 Remediation Impact: If ulimits are set incorrectly this could cause issues with system resources, possibly causing a denial of service condition.
[1;34m[INFO][0m 2.9 - Please consult the Docker documentation for various ways in which this can be configured depending upon your requirements. The high-level steps are: Ensure that the files /etc/subuid and /etc/subgid exist. Start the docker daemon with --userns-remap flag. Remediation Impact: User namespace remapping is incompatible with a number of Docker features and also currently breaks some of its functionalities.
[1;34m[INFO][0m 2.12 - Install/Create an authorization plugin. Configure the authorization policy as desired. Start the docker daemon using command dockerd --authorization-plugin=<PLUGIN_ID> Remediation Impact: Each Docker command needs to pass through the authorization plugin mechanism. This may have a performance impact
[1;34m[INFO][0m 2.13 - Set up the desired log driver following its documentation. Start the docker daemon using that logging driver. Example: dockerd --log-driver=syslog --log-opt syslog-address=tcp://192.xxx.xxx.xxx Remediation Impact: None.
[1;34m[INFO][0m 2.14 - You should run the Docker daemon using command: dockerd --no-new-privileges Remediation Impact: no_new_priv prevents LSMs such as SELinux from escalating the privileges of individual containers.
[1;34m[INFO][0m 2.15 - Run Docker in daemon mode and pass --live-restore option. Remediation Impact: None.
[1;34m[INFO][0m 2.16 - You should run the Docker daemon using command: dockerd --userland-proxy=false Remediation Impact: Some systems with older Linux kernels may not be able to support hairpin NAT and therefore require the userland proxy service. Also, some networking setups can be impacted by the removal of the userland proxy.
[1;34m[INFO][0m 2.17 - By default, Docker's default seccomp profile is applied. If this is adequate for your environment, no action is necessary. Remediation Impact: A misconfigured seccomp profile could possibly interrupt your container environment. You should therefore exercise extreme care if you choose to override the default settings.
[1;34m[INFO][0m 2.18 - You should not pass --experimental as a runtime parameter to the Docker daemon on production systems. Remediation Impact: None.

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;34m[INFO][0m 3.7 - You should run the following command: chown root:root /etc/docker/certs.d/<registry-name>/*. This would set the individual ownership and group ownership for the registry certificate files to root. Remediation Impact: None.
[1;34m[INFO][0m 3.8 - You should run the following command: chmod 444 /etc/docker/certs.d/<registry-name>/*. This would set the permissions for the registry certificate files to 444. Remediation Impact: None.
[1;34m[INFO][0m 3.9 - You should run the following command: chown root:root <path to TLS CA certificate file>. This sets the individual ownership and group ownership for the TLS CA certificate file to root. Remediation Impact: None.
[1;34m[INFO][0m 3.10 - You should run the following command: chmod 444 <path to TLS CA certificate file>. This sets the file permissions on the TLS CA file to 444. Remediation Impact: None.
[1;34m[INFO][0m 3.11 - You should run the following command: chown root:root <path to Docker server certificate file>. This sets the individual ownership and the group ownership for the Docker server certificate file to root. Remediation Impact: None.
[1;34m[INFO][0m 3.12 - You should run the following command: chmod 444 <path to Docker server certificate file>. This sets the file permissions of the Docker server certificate file to 444. Remediation Impact: None.
[1;34m[INFO][0m 3.13 - You should run the following command: chown root:root <path to Docker server certificate key file>. This sets the individual ownership and group ownership for the Docker server certificate key file to root. Remediation Impact: None.
[1;34m[INFO][0m 3.14 - You should run the following command: chmod 400 <path to Docker server certificate key file>. This sets the Docker server certificate key file permissions to 400. Remediation Impact: None.
[1;34m[INFO][0m 3.21 - You should run the following command: chmod 644 /etc/sysconfig/docker. This sets the file permissions for this file to 644. Remediation Impact: None.
[1;34m[INFO][0m 3.22 - You should run the following command: chown root:root /etc/sysconfig/docker. This sets the ownership and group ownership for the file to root. Remediation Impact: None.

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - You should ensure that the Dockerfile for each container image contains the information: USER <username or ID>. If there is no specific user created in the container base image, then make use of the useradd command to add a specific user before the USER instruction in the Dockerfile. Remediation Impact: Running as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.
[1;34m[INFO][0m 4.2 - Configure and use Docker Content trust. View the history of each Docker image to evaluate its risk, dependent on the sensitivity of the application you wish to deploy using it. Scan Docker images for vulnerabilities at regular intervals. Remediation Impact: None.
[1;34m[INFO][0m 4.3 - You should not install anything within the container that is not required. You should consider using a minimal base image if you can. Some of the options available include BusyBox and Alpine. Not only can this trim your image size considerably, but there would also be fewer pieces of software which could contain vectors for attack. Remediation Impact: None.
[1;34m[INFO][0m 4.4 - Images should be re-built ensuring that the latest version of the base images are used, to keep the operating system patch level at an appropriate level. Once the images have been re-built, containers should be re-started making use of the updated images. Remediation Impact: None.
[1;34m[INFO][0m 4.7 - You should use update instructions together with install instructions and version pinning for packages while installing them. This prevent caching and force the extraction of the required versions. Alternatively, you could use the --no-cache flag during the docker build process to avoid using cached layers. Remediation Impact: None.
[1;34m[INFO][0m 4.8 - You should allow setuid and setgid permissions only on executables which require them. You could remove these permissions at build time by adding the following command in your Dockerfile, preferably towards the end of the Dockerfile: RUN find / -perm /6000 -type f -exec chmod a-s {} ; || true Remediation Impact: The above command would break all executables that depend on setuid or setgid permissions including legitimate ones. You should therefore be careful to modify the command to suit your requirements so that it does not reduce the permissions of legitimate programs excessively. Because of this, you should exercise a degree of caution and examine all processes carefully before making this type of modification in order to avoid outages.
[1;34m[INFO][0m 4.9 - You should use COPY rather than ADD instructions in Dockerfiles. Remediation Impact: Care needs to be taken in implementing this control if the application requires functionality that is part of the ADD instruction, for example, if you need to retrieve files from remote URLS.
[1;34m[INFO][0m 4.10 - Do not store any kind of secrets within Dockerfiles. Where secrets are required during the build process, make use of a secrets management tool, such as the buildkit builder included with Docker. Remediation Impact: A proper secrets management process will be required for Docker image building.
[1;34m[INFO][0m 4.11 - You should use a secure package distribution mechanism of your choice to ensure the authenticity of software packages. Remediation Impact: None.
[1;34m[INFO][0m 4.12 - Validate artifacts signatures before uploading to the package registry. Remediation Impact: None.

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - You should keep only the images that you actually need and establish a workflow to remove old or stale images from the host. Additionally, you should use features such as pull-by-digest to get specific images from the registry. Remediation Impact: docker system prune -a removes all exited containers as well as all images and volumes that are not referenced by running containers, including for UCP and DTR.
[1;34m[INFO][0m 6.2 - You should periodically check your container inventory on each host and clean up containers which are not in active use with the command: docker container prune Remediation Impact: You should retain containers that are actively in use, and delete ones which are no longer needed.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 26

Initializing 2025-01-23T11:10:21+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 26

Initializing 2025-01-23T11:32:15+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;31m[WARN][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 26

Initializing 2025-01-23T11:32:50+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 28

Initializing 2025-01-23T11:33:35+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 28

Initializing 2025-01-23T11:37:34+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;31m[WARN][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;31m[WARN][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;31m[WARN][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;31m[WARN][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;31m[WARN][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;31m[WARN][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;31m[WARN][0m 2.15 - Ensure live restore is enabled (Scored)
[1;31m[WARN][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 28

Initializing 2025-01-23T11:46:18+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;31m[WARN][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 64

Initializing 2025-01-23T11:49:09+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;31m[WARN][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m      * No AppArmorProfile Found: caddy
[1;31m[WARN][0m      * No AppArmorProfile Found: flask_app
[1;31m[WARN][0m      * No AppArmorProfile Found: redis
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 66

Initializing 2025-01-23T11:58:43+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 46

Initializing 2025-01-23T11:59:01+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 68

Initializing 2025-01-23T12:48:48+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;34m[INFO][0m      * No containers running
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m   * No containers running, skipping Section 5
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 0 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 86
[1;34m[INFO][0m Score: 46

Initializing 2025-01-23T18:12:58+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 68

Initializing 2025-01-23T18:25:45+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 68

Initializing 2025-01-23T18:36:31+01:00


[1;33mSection A - Check results[0m

[1;34m[INFO][0m 1 - Host Configuration
[1;34m[INFO][0m 1.1 - Linux Hosts Specific Configuration
[1;31m[WARN][0m 1.1.1 - Ensure a separate partition for containers has been created (Automated)
[1;34m[INFO][0m 1.1.2 - Ensure only trusted users are allowed to control Docker daemon (Automated)
[1;34m[INFO][0m       * Users: 
[1;32m[PASS][0m 1.1.3 - Ensure auditing is configured for the Docker daemon (Automated)
[1;32m[PASS][0m 1.1.4 - Ensure auditing is configured for Docker files and directories -/run/containerd (Automated)
[1;32m[PASS][0m 1.1.5 - Ensure auditing is configured for Docker files and directories - /var/lib/docker (Automated)
[1;32m[PASS][0m 1.1.6 - Ensure auditing is configured for Docker files and directories - /etc/docker (Automated)
[1;32m[PASS][0m 1.1.7 - Ensure auditing is configured for Docker files and directories - docker.service (Automated)
[1;32m[PASS][0m 1.1.8 - Ensure auditing is configured for Docker files and directories - containerd.sock (Automated)
[1;32m[PASS][0m 1.1.9 - Ensure auditing is configured for Docker files and directories - docker.socket (Automated)
[1;32m[PASS][0m 1.1.10 - Ensure auditing is configured for Docker files and directories - /etc/default/docker (Automated)
[1;32m[PASS][0m 1.1.11 - Ensure auditing is configured for Dockerfiles and directories - /etc/docker/daemon.json (Automated)
[1;32m[PASS][0m 1.1.12 - 1.1.12 Ensure auditing is configured for Dockerfiles and directories - /etc/containerd/config.toml (Automated)
[1;34m[INFO][0m 1.1.13 - Ensure auditing is configured for Docker files and directories - /etc/sysconfig/docker (Automated)
[1;34m[INFO][0m        * File not found
[1;32m[PASS][0m 1.1.14 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd (Automated)
[1;32m[PASS][0m 1.1.15 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim (Automated)
[1;32m[PASS][0m 1.1.16 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v1 (Automated)
[1;32m[PASS][0m 1.1.17 - Ensure auditing is configured for Docker files and directories - /usr/bin/containerd-shim-runc-v2 (Automated)
[1;32m[PASS][0m 1.1.18 - Ensure auditing is configured for Docker files and directories - /usr/bin/runc (Automated)
[1;34m[INFO][0m 1.2 - General Configuration
[1;33m[NOTE][0m 1.2.1 - Ensure the container host has been Hardened (Manual)
[1;32m[PASS][0m 1.2.2 - Ensure that the version of Docker is up to date (Manual)
[1;34m[INFO][0m        * Using 27.4.1 which is current
[1;34m[INFO][0m        * Check with your operating system vendor for support and security maintenance for Docker

[1;34m[INFO][0m 2 - Docker daemon configuration
[1;33m[NOTE][0m 2.1 - Run the Docker daemon as a non-root user, if possible (Manual)
[1;32m[PASS][0m 2.2 - Ensure network traffic is restricted between containers on the default bridge (Scored)
[1;32m[PASS][0m 2.3 - Ensure the logging level is set to 'info' (Scored)
[1;32m[PASS][0m 2.4 - Ensure Docker is allowed to make changes to iptables (Scored)
[1;32m[PASS][0m 2.5 - Ensure insecure registries are not used (Scored)
[1;32m[PASS][0m 2.6 - Ensure aufs storage driver is not used (Scored)
[1;34m[INFO][0m 2.7 - Ensure TLS authentication for Docker daemon is configured (Scored)
[1;34m[INFO][0m      * Docker daemon not listening on TCP
[1;34m[INFO][0m 2.8 - Ensure the default ulimit is configured appropriately (Manual)
[1;34m[INFO][0m      * Default ulimit doesn't appear to be set
[1;32m[PASS][0m 2.9 - Enable user namespace support (Scored)
[1;32m[PASS][0m 2.10 - Ensure the default cgroup usage has been confirmed (Scored)
[1;32m[PASS][0m 2.11 - Ensure base device size is not changed until needed (Scored)
[1;31m[WARN][0m 2.12 - Ensure that authorization for Docker client commands is enabled (Scored)
[1;32m[PASS][0m 2.13 - Ensure centralized and remote logging is configured (Scored)
[1;32m[PASS][0m 2.14 - Ensure containers are restricted from acquiring new privileges (Scored)
[1;32m[PASS][0m 2.15 - Ensure live restore is enabled (Scored)
[1;32m[PASS][0m 2.16 - Ensure Userland Proxy is Disabled (Scored)
[1;34m[INFO][0m 2.17 - Ensure that a daemon-wide custom seccomp profile is applied if appropriate (Manual)
[1;34m[INFO][0m Ensure that experimental features are not implemented in production (Scored) (Deprecated)

[1;34m[INFO][0m 3 - Docker daemon configuration files
[1;32m[PASS][0m 3.1 - Ensure that the docker.service file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.2 - Ensure that docker.service file permissions are appropriately set (Automated)
[1;32m[PASS][0m 3.3 - Ensure that docker.socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.4 - Ensure that docker.socket file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.5 - Ensure that the /etc/docker directory ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.6 - Ensure that /etc/docker directory permissions are set to 755 or more restrictively (Automated)
[1;34m[INFO][0m 3.7 - Ensure that registry certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.8 - Ensure that registry certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m      * Directory not found
[1;34m[INFO][0m 3.9 - Ensure that TLS CA certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m      * No TLS CA certificate found
[1;34m[INFO][0m 3.10 - Ensure that TLS CA certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS CA certificate found
[1;34m[INFO][0m 3.11 - Ensure that Docker server certificate file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.12 - Ensure that the Docker server certificate file permissions are set to 444 or more restrictively (Automated)
[1;34m[INFO][0m       * No TLS Server certificate found
[1;34m[INFO][0m 3.13 - Ensure that the Docker server certificate key file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;34m[INFO][0m 3.14 - Ensure that the Docker server certificate key file permissions are set to 400 (Automated)
[1;34m[INFO][0m       * No TLS Key found
[1;32m[PASS][0m 3.15 - Ensure that the Docker socket file ownership is set to root:docker (Automated)
[1;32m[PASS][0m 3.16 - Ensure that the Docker socket file permissions are set to 660 or more restrictively (Automated)
[1;32m[PASS][0m 3.17 - Ensure that the daemon.json file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.18 - Ensure that daemon.json file permissions are set to 644 or more restrictive (Automated)
[1;32m[PASS][0m 3.19 - Ensure that the /etc/default/docker file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.20 - Ensure that the /etc/default/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m 3.21 - Ensure that the /etc/sysconfig/docker file permissions are set to 644 or more restrictively (Automated)
[1;34m[INFO][0m       * File not found
[1;34m[INFO][0m 3.22 - Ensure that the /etc/sysconfig/docker file ownership is set to root:root (Automated)
[1;34m[INFO][0m       * File not found
[1;32m[PASS][0m 3.23 - Ensure that the Containerd socket file ownership is set to root:root (Automated)
[1;32m[PASS][0m 3.24 - Ensure that the Containerd socket file permissions are set to 660 or more restrictively (Automated)

[1;34m[INFO][0m 4 - Container Images and Build File
[1;32m[PASS][0m 4.1 - Ensure that a user for the container has been created (Automated)
[1;33m[NOTE][0m 4.2 - Ensure that containers use only trusted base images (Manual)
[1;33m[NOTE][0m 4.3 - Ensure that unnecessary packages are not installed in the container (Manual)
[1;33m[NOTE][0m 4.4 - Ensure images are scanned and rebuilt to include security patches (Manual)
[1;32m[PASS][0m 4.5 - Ensure Content trust for Docker is Enabled (Automated)
[1;32m[PASS][0m 4.6 - Ensure that HEALTHCHECK instructions have been added to container images (Automated)
[1;34m[INFO][0m 4.7 - Ensure update instructions are not used alone in the Dockerfile (Manual)
[1;34m[INFO][0m      * Update instruction found: [ynov-docker-backend:latest]
[1;33m[NOTE][0m 4.8 - Ensure setuid and setgid permissions are removed (Manual)
[1;34m[INFO][0m 4.9 - Ensure that COPY is used instead of ADD in Dockerfiles (Manual)
[1;34m[INFO][0m      * ADD in image history: [ynov-docker-caddy:latest]
[1;33m[NOTE][0m 4.10 - Ensure secrets are not stored in Dockerfiles (Manual)
[1;33m[NOTE][0m 4.11 - Ensure only verified packages are installed (Manual)
[1;33m[NOTE][0m 4.12 - Ensure all signed artifacts are validated (Manual)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1 - Ensure swarm mode is not Enabled, if not needed (Automated)
[1;32m[PASS][0m 5.2 - Ensure that, if applicable, an AppArmor Profile is enabled (Automated)
[1;31m[WARN][0m 5.3 - Ensure that, if applicable, SELinux security options are set (Automated)
[1;31m[WARN][0m      * No SecurityOptions Found: caddy
[1;31m[WARN][0m      * No SecurityOptions Found: flask_app
[1;31m[WARN][0m      * No SecurityOptions Found: redis
[1;32m[PASS][0m 5.4 - Ensure that Linux kernel capabilities are restricted within containers (Automated)
[1;32m[PASS][0m 5.5 - Ensure that privileged containers are not used (Automated)
[1;32m[PASS][0m 5.6 - Ensure sensitive host system directories are not mounted on containers (Automated)
[1;32m[PASS][0m 5.7 - Ensure sshd is not run within containers (Automated)
[1;32m[PASS][0m 5.8 - Ensure privileged ports are not mapped within containers (Automated)
[1;31m[WARN][0m 5.9 - Ensure that only needed ports are open on the container (Manual)
[1;31m[WARN][0m      * Port in use: 8080 in caddy
[1;32m[PASS][0m 5.10 - Ensure that the host's network namespace is not shared (Automated)
[1;32m[PASS][0m 5.11 - Ensure that the memory usage for containers is limited (Automated)
[1;32m[PASS][0m 5.12 - Ensure that CPU priority is set appropriately on containers (Automated)
[1;32m[PASS][0m 5.13 - Ensure that the container's root filesystem is mounted as read only (Automated)
[1;32m[PASS][0m 5.14 - Ensure that incoming container traffic is bound to a specific host interface (Automated)
[1;32m[PASS][0m 5.15 - Ensure that the 'on-failure' container restart policy is set to '5' (Automated)
[1;32m[PASS][0m 5.16 - Ensure that the host's process namespace is not shared (Automated)
[1;32m[PASS][0m 5.17 - Ensure that the host's IPC namespace is not shared (Automated)
[1;32m[PASS][0m 5.18 - Ensure that host devices are not directly exposed to containers (Manual)
[1;34m[INFO][0m 5.19 - Ensure that the default ulimit is overwritten at runtime if needed (Manual)
[1;34m[INFO][0m       * Container no default ulimit override: caddy
[1;34m[INFO][0m       * Container no default ulimit override: flask_app
[1;34m[INFO][0m       * Container no default ulimit override: redis
[1;32m[PASS][0m 5.20 - Ensure mount propagation mode is not set to shared (Automated)
[1;32m[PASS][0m 5.21 - Ensure that the host's UTS namespace is not shared (Automated)
[1;32m[PASS][0m 5.22 - Ensure the default seccomp profile is not Disabled (Automated)
[1;33m[NOTE][0m 5.23 - Ensure that docker exec commands are not used with the privileged option (Automated)
[1;33m[NOTE][0m 5.24 - Ensure that docker exec commands are not used with the user=root option (Manual)
[1;32m[PASS][0m 5.25 - Ensure that cgroup usage is confirmed (Automated)
[1;32m[PASS][0m 5.26 - Ensure that the container is restricted from acquiring additional privileges (Automated)
[1;32m[PASS][0m 5.27 - Ensure that container health is checked at runtime (Automated)
[1;34m[INFO][0m 5.28 - Ensure that Docker commands always make use of the latest version of their image (Manual)
[1;32m[PASS][0m 5.29 - Ensure that the PIDs cgroup limit is used (Automated)
[1;32m[PASS][0m 5.30 - Ensure that Docker's default bridge 'docker0' is not used (Manual)
[1;32m[PASS][0m 5.31 - Ensure that the host's user namespaces are not shared (Automated)
[1;32m[PASS][0m 5.32 - Ensure that the Docker socket is not mounted inside any containers (Automated)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - Ensure that image sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently: 3 images
[1;34m[INFO][0m 6.2 - Ensure that container sprawl is avoided (Manual)
[1;34m[INFO][0m      * There are currently a total of 3 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1 - Ensure that the minimum number of manager nodes have been created in a swarm (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.2 - Ensure that swarm services are bound to a specific host interface (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3 - Ensure that all Docker swarm overlay networks are encrypted (Automated)
[1;32m[PASS][0m 7.4 - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.5 - Ensure that swarm manager is run in auto-lock mode (Automated) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6 - Ensure that the swarm manager auto-lock key is rotated periodically (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7 - Ensure that node certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8 - Ensure that CA certificates are rotated as appropriate (Manual) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9 - Ensure that management plane traffic is separated from data plane traffic (Manual) (Swarm mode not enabled)


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 117
[1;34m[INFO][0m Score: 68

